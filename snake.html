<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¥æ°´æœéŠæˆ² - ç°¡åŒ–ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial Rounded MT Bold', 'Arial', sans-serif;
        }
        
        body {
            background: linear-gradient(to bottom, #87CEEB, #E0F7FF);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            overflow-x: hidden;
        }
        
        header {
            text-align: center;
            margin-bottom: 20px;
            width: 100%;
            max-width: 800px;
        }
        
        h1 {
            color: #FF6B6B;
            font-size: 3rem;
            text-shadow: 3px 3px 0 #FFD166;
            margin-bottom: 10px;
            letter-spacing: 2px;
        }
        
        .subtitle {
            color: #5D4037;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .game-container {
            position: relative;
            width: 800px;
            max-width: 95vw;
            height: 600px;
            max-height: 70vh;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            overflow: hidden;
            border: 10px solid #5D4037;
        }
        
        #gameCanvas {
            width: 100%;
            height: 100%;
            display: block;
            background-color: #E8F5E9;
        }
        
        .game-ui {
            display: flex;
            justify-content: space-between;
            width: 800px;
            max-width: 95vw;
            margin-top: 20px;
            padding: 15px 25px;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .score-container, .lives-container, .level-container {
            text-align: center;
        }
        
        .game-ui h3 {
            color: #5D4037;
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .score-value, .level-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #FF6B6B;
        }
        
        .lives-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: #4CAF50;
        }
        
        .level-value {
            color: #2196F3;
        }
        
        .controls {
            margin-top: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 15px;
            width: 800px;
            max-width: 95vw;
            text-align: center;
        }
        
        .controls h3 {
            color: #5D4037;
            margin-bottom: 10px;
        }
        
        .controls p {
            color: #5D4037;
            margin-bottom: 10px;
        }
        
        .control-keys {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }
        
        .key {
            background-color: #FFD166;
            padding: 8px 15px;
            border-radius: 8px;
            font-weight: bold;
            color: #5D4037;
            box-shadow: 0 3px 0 #FFB300;
        }
        
        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 5px 0 rgba(0, 0, 0, 0.2);
        }
        
        button:hover {
            transform: translateY(-3px);
        }
        
        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 0 rgba(0, 0, 0, 0.2);
        }
        
        #startBtn {
            background-color: #4CAF50;
            color: white;
        }
        
        #pauseBtn {
            background-color: #FFB300;
            color: white;
        }
        
        #resetBtn {
            background-color: #F44336;
            color: white;
        }
        
        .instructions {
            margin-top: 25px;
            background-color: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 15px;
            width: 800px;
            max-width: 95vw;
        }
        
        .instructions h3 {
            color: #5D4037;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.5rem;
        }
        
        .instructions ul {
            padding-left: 20px;
            color: #5D4037;
        }
        
        .instructions li {
            margin-bottom: 8px;
            line-height: 1.5;
        }
        
        .fruit-types {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .fruit-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .fruit-icon {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
        }
        
        .apple { background-color: #FF5252; }
        .banana { background-color: #FFD740; }
        .orange { background-color: #FF9800; }
        .watermelon { background-color: #4CAF50; }
        .bomb { background-color: #424242; }
        
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            border-radius: 10px;
        }
        
        .game-over h2 {
            color: #FFD166;
            font-size: 3.5rem;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(255, 209, 102, 0.5);
        }
        
        .game-over p {
            color: white;
            font-size: 1.8rem;
            margin-bottom: 30px;
        }
        
        .game-over button {
            background-color: #4CAF50;
            color: white;
            font-size: 1.5rem;
            padding: 15px 40px;
        }
        
        .life-icons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }
        
        .life-icon {
            width: 30px;
            height: 30px;
            background-color: #4CAF50;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        
        .life-icon.lost {
            background-color: #F44336;
            opacity: 0.5;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .game-container {
                height: 500px;
            }
            
            .game-ui {
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
            }
            
            .score-value, .lives-value, .level-value {
                font-size: 2rem;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .game-container {
                height: 400px;
            }
            
            .fruit-types {
                flex-direction: column;
                align-items: center;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>æ¥æ°´æœéŠæˆ²</h1>
        <p class="subtitle">ç”Ÿå‘½åªæœ‰ä¸‰æ¬¡ï¼Œç¢°åˆ°ç‚¸å½ˆæ‰£ä¸€å€‹ç”Ÿå‘½ï¼</p>
    </header>
    
    <div class="game-container">
        <canvas id="gameCanvas"></canvas>
        <div class="game-over" id="gameOverScreen">
            <h2>éŠæˆ²çµæŸ!</h2>
            <p>å¾—åˆ†: <span id="finalScore">0</span></p>
            <button id="restartBtn">å†ç©ä¸€æ¬¡</button>
        </div>
    </div>
    
    <div class="game-ui">
        <div class="score-container">
            <h3>åˆ†æ•¸</h3>
            <div class="score-value" id="score">0</div>
        </div>
        <div class="lives-container">
            <h3>ç”Ÿå‘½</h3>
            <div class="lives-value" id="lives">3</div>
            <div class="life-icons" id="lifeIcons">
                <div class="life-icon">â¤</div>
                <div class="life-icon">â¤</div>
                <div class="life-icon">â¤</div>
            </div>
        </div>
        <div class="level-container">
            <h3>é—œå¡</h3>
            <div class="level-value" id="level">1</div>
        </div>
    </div>
    
    <div class="controls">
        <h3>éŠæˆ²æ§åˆ¶</h3>
        <p>ä½¿ç”¨æ»‘é¼ ç§»å‹•ç±ƒå­ æˆ– ä½¿ç”¨å·¦å³æ–¹å‘éµæ§åˆ¶</p>
        <div class="control-keys">
            <div class="key">â† å·¦ç§»</div>
            <div class="key">â†’ å³ç§»</div>
        </div>
        
        <div class="buttons">
            <button id="startBtn">é–‹å§‹éŠæˆ²</button>
            <button id="pauseBtn">æš«åœ</button>
            <button id="resetBtn">é‡æ–°é–‹å§‹</button>
        </div>
    </div>
    
    <div class="instructions">
        <h3>éŠæˆ²èªªæ˜</h3>
        <ul>
            <li>ç§»å‹•ç±ƒå­æ¥ä½å¾å¤©è€Œé™çš„æ°´æœï¼Œç²å¾—é«˜åˆ†</li>
            <li>ä¸åŒæ°´æœæœ‰ä¸åŒçš„åˆ†æ•¸ï¼šè˜‹æœ(10åˆ†)ã€é¦™è•‰(15åˆ†)ã€æ©™å­(20åˆ†)ã€è¥¿ç“œ(25åˆ†)</li>
            <li>åªæœ‰ç¢°åˆ°ç‚¸å½ˆæ‰æœƒæ‰£ç”Ÿå‘½ï¼Œæ°´æœè½åœ°ä¸æœƒæ‰£ç”Ÿå‘½</li>
            <li>ç”Ÿå‘½åªæœ‰ä¸‰æ¬¡æ©Ÿæœƒï¼Œæ¯ç¢°ä¸€æ¬¡ç‚¸å½ˆæ‰£ä¸€å€‹ç”Ÿå‘½</li>
            <li>ä¸‰å€‹ç”Ÿå‘½éƒ½ç”¨å®Œæ™‚éŠæˆ²çµæŸ</li>
            <li>æ¯ç²å¾—100åˆ†é€²å…¥ä¸‹ä¸€é—œï¼Œæ°´æœä¸‹è½é€Ÿåº¦æœƒå¢åŠ </li>
        </ul>
        
        <div class="fruit-types">
            <div class="fruit-item">
                <div class="fruit-icon apple"></div>
                <span>è˜‹æœ: 10åˆ†</span>
            </div>
            <div class="fruit-item">
                <div class="fruit-icon banana"></div>
                <span>é¦™è•‰: 15åˆ†</span>
            </div>
            <div class="fruit-item">
                <div class="fruit-icon orange"></div>
                <span>æ©™å­: 20åˆ†</span>
            </div>
            <div class="fruit-item">
                <div class="fruit-icon watermelon"></div>
                <span>è¥¿ç“œ: 25åˆ†</span>
            </div>
            <div class="fruit-item">
                <div class="fruit-icon bomb">ğŸ’£</div>
                <span>ç‚¸å½ˆ: æ‰£1ç”Ÿå‘½</span>
            </div>
        </div>
    </div>

    <script>
        // ç²å–Canvaså…ƒç´ å’Œä¸Šä¸‹æ–‡
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // è¨­ç½®Canvaså°ºå¯¸
        canvas.width = canvas.parentElement.clientWidth;
        canvas.height = canvas.parentElement.clientHeight;
        
        // éŠæˆ²è®Šæ•¸
        let score = 0;
        let lives = 3; // åªæœ‰ä¸‰æ¬¡ç”Ÿå‘½
        let level = 1;
        let gameRunning = false;
        let gamePaused = false;
        let gameLoop;
        
        // ç±ƒå­å±¬æ€§
        const basket = {
            x: canvas.width / 2 - 50,
            y: canvas.height - 80,
            width: 100,
            height: 60,
            speed: 10,
            color: '#FF9800',
            movingLeft: false,
            movingRight: false
        };
        
        // æ°´æœé¡å‹ - ç°¡åŒ–ç‰ˆæœ¬ï¼Œåªæœ‰å››ç¨®æ°´æœå’Œç‚¸å½ˆ
        const fruitTypes = [
            { name: 'apple', color: '#FF5252', score: 10, radius: 20 },
            { name: 'banana', color: '#FFD740', score: 15, radius: 22 },
            { name: 'orange', color: '#FF9800', score: 20, radius: 25 },
            { name: 'watermelon', color: '#4CAF50', score: 25, radius: 28 },
            { name: 'bomb', color: '#424242', score: 0, radius: 23, isBomb: true }
        ];
        
        // æ°´æœé™£åˆ—
        let fruits = [];
        
        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            score = 0;
            lives = 3;
            level = 1;
            fruits = [];
            basket.x = canvas.width / 2 - 50;
            
            updateUI();
            updateLifeIcons();
            
            // éš±è—éŠæˆ²çµæŸç•«é¢
            document.getElementById('gameOverScreen').style.display = 'none';
            
            // ç¹ªè£½åˆå§‹ç•«é¢
            draw();
        }
        
        // æ›´æ–°ç”Ÿå‘½åœ–æ¨™
        function updateLifeIcons() {
            const lifeIcons = document.getElementById('lifeIcons');
            lifeIcons.innerHTML = '';
            
            for (let i = 0; i < 3; i++) {
                const lifeIcon = document.createElement('div');
                lifeIcon.className = i < lives ? 'life-icon' : 'life-icon lost';
                lifeIcon.textContent = 'â¤';
                lifeIcons.appendChild(lifeIcon);
            }
        }
        
        // ç¹ªè£½ç±ƒå­
        function drawBasket() {
            // ç±ƒå­ä¸»é«”
            ctx.fillStyle = basket.color;
            ctx.fillRect(basket.x, basket.y, basket.width, basket.height);
            
            // ç±ƒå­é‚Šç·£
            ctx.fillStyle = '#5D4037';
            ctx.fillRect(basket.x, basket.y, basket.width, 10);
            ctx.fillRect(basket.x, basket.y + basket.height - 10, basket.width, 10);
            
            // ç±ƒå­å…§éƒ¨ç·šæ¢
            ctx.strokeStyle = '#8D6E63';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(basket.x + 10, basket.y + 10);
            ctx.lineTo(basket.x + basket.width - 10, basket.y + 10);
            ctx.moveTo(basket.x + 10, basket.y + basket.height - 20);
            ctx.lineTo(basket.x + basket.width - 10, basket.y + basket.height - 20);
            ctx.stroke();
            
            // ç±ƒå­æŠŠæ‰‹
            ctx.strokeStyle = '#5D4037';
            ctx.lineWidth = 8;
            ctx.beginPath();
            ctx.arc(basket.x + basket.width/2, basket.y - 10, 25, Math.PI, 0);
            ctx.stroke();
        }
        
        // ç¹ªè£½æ°´æœ
        function drawFruit(fruit) {
            // æ°´æœä¸»é«”
            ctx.fillStyle = fruit.color;
            ctx.beginPath();
            ctx.arc(fruit.x, fruit.y, fruit.radius, 0, Math.PI * 2);
            ctx.fill();
            
            // æ°´æœé«˜å…‰
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.beginPath();
            ctx.arc(fruit.x - fruit.radius/3, fruit.y - fruit.radius/3, fruit.radius/4, 0, Math.PI * 2);
            ctx.fill();
            
            // ç‚¸å½ˆçš„ç‰¹æ®Šæ¨™è¨˜
            if (fruit.isBomb) {
                // ç‚¸å½ˆå¼•ä¿¡
                ctx.fillStyle = '#FF5722';
                ctx.fillRect(fruit.x + fruit.radius/2, fruit.y - fruit.radius, 5, 15);
                
                // ç«èŠ±
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.arc(fruit.x + fruit.radius/2 + 2, fruit.y - fruit.radius - 5, 3, 0, Math.PI * 2);
                ctx.fill();
            }
            
            // æ°´æœé™°å½±
            ctx.shadowColor = 'rgba(0, 0, 0, 0.3)';
            ctx.shadowBlur = 5;
            ctx.shadowOffsetX = 2;
            ctx.shadowOffsetY = 2;
            
            // é‡ç½®é™°å½±
            ctx.shadowColor = 'transparent';
            ctx.shadowBlur = 0;
            ctx.shadowOffsetX = 0;
            ctx.shadowOffsetY = 0;
        }
        
        // ç”Ÿæˆæ–°æ°´æœ
        function generateFruit() {
            // éš¨æ©Ÿæ±ºå®šæ˜¯å¦ç”Ÿæˆæ°´æœï¼ˆéš¨è‘—ç­‰ç´šæé«˜ï¼Œç”Ÿæˆé »ç‡å¢åŠ ï¼‰
            const spawnChance = Math.min(0.05 + level * 0.004, 0.15);
            if (Math.random() < spawnChance) {
                let typeIndex;
                
                // ç‚¸å½ˆæ©Ÿç‡ï¼š15%
                // æ™®é€šæ°´æœæ©Ÿç‡ï¼š85%
                const rand = Math.random();
                
                if (rand < 0.15) {
                    // 15%æ©Ÿç‡ç”Ÿæˆç‚¸å½ˆ
                    typeIndex = 4; // ç‚¸å½ˆçš„ç´¢å¼•
                } else {
                    // 85%æ©Ÿç‡ç”Ÿæˆæ™®é€šæ°´æœ
                    typeIndex = Math.floor(Math.random() * 4); // 0-3ï¼Œå››ç¨®æ°´æœ
                }
                
                const fruitType = fruitTypes[typeIndex];
                
                const fruit = {
                    x: Math.random() * (canvas.width - 40) + 20,
                    y: -30,
                    radius: fruitType.radius,
                    color: fruitType.color,
                    score: fruitType.score,
                    speed: 2 + level * 0.5,
                    isBomb: fruitType.isBomb || false,
                    name: fruitType.name
                };
                
                fruits.push(fruit);
            }
        }
        
        // æ›´æ–°æ°´æœä½ç½®
        function updateFruits() {
            for (let i = fruits.length - 1; i >= 0; i--) {
                const fruit = fruits[i];
                fruit.y += fruit.speed;
                
                // æª¢æŸ¥æ°´æœæ˜¯å¦è¢«ç±ƒå­æ¥ä½
                if (
                    fruit.y + fruit.radius > basket.y &&
                    fruit.x > basket.x &&
                    fruit.x < basket.x + basket.width
                ) {
                    // æ¥åˆ°æ°´æœ
                    if (fruit.isBomb) {
                        // æ¥åˆ°ç‚¸å½ˆ - æ‰£ç”Ÿå‘½
                        lives--;
                        
                        // ç”Ÿå‘½å€¼ç‚º0æ™‚éŠæˆ²çµæŸ
                        if (lives <= 0) {
                            endGame();
                        }
                    } else {
                        // æ¥åˆ°æ™®é€šæ°´æœ - å¢åŠ åˆ†æ•¸
                        score += fruit.score;
                        
                        // æ¯100åˆ†å‡ä¸€ç´š
                        level = Math.floor(score / 100) + 1;
                    }
                    
                    // ç§»é™¤æ°´æœ
                    fruits.splice(i, 1);
                    updateUI();
                    updateLifeIcons();
                    
                    continue;
                }
                
                // æª¢æŸ¥æ°´æœæ˜¯å¦è½åœ°
                // æ°´æœè½åœ°ä¸æœƒæ‰£ç”Ÿå‘½
                if (fruit.y > canvas.height + 50) {
                    fruits.splice(i, 1);
                }
            }
        }
        
        // ç¹ªè£½æ‰€æœ‰éŠæˆ²å…ƒç´ 
        function draw() {
            // æ¸…é™¤ç•«å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç¹ªè£½èƒŒæ™¯
            drawBackground();
            
            // ç¹ªè£½æ°´æœ
            fruits.forEach(fruit => drawFruit(fruit));
            
            // ç¹ªè£½ç±ƒå­
            drawBasket();
            
            // ç¹ªè£½éŠæˆ²ä¿¡æ¯
            drawGameInfo();
        }
        
        // ç¹ªè£½èƒŒæ™¯
        function drawBackground() {
            // å¤©ç©º
            ctx.fillStyle = '#E8F5E9';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // é›²æœµ
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            for (let i = 0; i < 3; i++) {
                const cloudX = (Date.now() / 5000 + i * 1.5) % (canvas.width + 200) - 100;
                const cloudY = 50 + i * 60;
                drawCloud(cloudX, cloudY, 60 + i * 10);
            }
            
            // åœ°é¢
            ctx.fillStyle = '#8BC34A';
            ctx.fillRect(0, canvas.height - 20, canvas.width, 20);
            
            // è‰åœ°ç´‹ç†
            ctx.fillStyle = '#7CB342';
            for (let i = 0; i < canvas.width; i += 10) {
                ctx.fillRect(i, canvas.height - 20, 5, 5);
            }
        }
        
        // ç¹ªè£½é›²æœµ
        function drawCloud(x, y, size) {
            ctx.beginPath();
            ctx.arc(x, y, size * 0.5, 0, Math.PI * 2);
            ctx.arc(x + size * 0.3, y - size * 0.2, size * 0.4, 0, Math.PI * 2);
            ctx.arc(x + size * 0.6, y, size * 0.5, 0, Math.PI * 2);
            ctx.arc(x - size * 0.3, y + size * 0.1, size * 0.4, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // ç¹ªè£½éŠæˆ²ä¿¡æ¯
        function drawGameInfo() {
            // åˆ†æ•¸é¡¯ç¤º
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.font = 'bold 20px Arial';
            ctx.textAlign = 'left';
            ctx.fillText(`åˆ†æ•¸: ${score}`, 20, 40);
            
            // ç”Ÿå‘½é¡¯ç¤º
            ctx.fillText(`ç”Ÿå‘½: ${lives}`, 20, 80);
            
            // é—œå¡é¡¯ç¤º
            ctx.fillText(`é—œå¡: ${level}`, 20, 120);
            
            // è¦å‰‡æç¤º
            ctx.font = '14px Arial';
            ctx.fillText('è¦å‰‡: åªæœ‰ç‚¸å½ˆæ‰£ç”Ÿå‘½ï¼Œæ°´æœè½åœ°ä¸æ‰£ç”Ÿå‘½', 20, canvas.height - 40);
            
            // å¦‚æœéŠæˆ²æš«åœï¼Œé¡¯ç¤ºæš«åœæ–‡å­—
            if (gamePaused) {
                ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                ctx.font = 'bold 60px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('éŠæˆ²æš«åœ', canvas.width / 2, canvas.height / 2);
            }
        }
        
        // æ›´æ–°ç±ƒå­ä½ç½®
        function updateBasket() {
            // éµç›¤æ§åˆ¶
            if (basket.movingLeft && basket.x > 0) {
                basket.x -= basket.speed;
            }
            if (basket.movingRight && basket.x + basket.width < canvas.width) {
                basket.x += basket.speed;
            }
        }
        
        // éŠæˆ²ä¸»å¾ªç’°
        function gameUpdate() {
            if (!gameRunning || gamePaused) return;
            
            updateBasket();
            generateFruit();
            updateFruits();
            draw();
        }
        
        // æ›´æ–°UIé¡¯ç¤º
        function updateUI() {
            document.getElementById('score').textContent = score;
            document.getElementById('lives').textContent = lives;
            document.getElementById('level').textContent = level;
        }
        
        // çµæŸéŠæˆ²
        function endGame() {
            gameRunning = false;
            clearInterval(gameLoop);
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOverScreen').style.display = 'flex';
        }
        
        // äº‹ä»¶ç›£è½å™¨
        function setupEventListeners() {
            // éµç›¤æ§åˆ¶
            document.addEventListener('keydown', (e) => {
                if (!gameRunning || gamePaused) return;
                
                if (e.key === 'ArrowLeft' || e.key === 'Left' || e.key === 'a') {
                    basket.movingLeft = true;
                }
                if (e.key === 'ArrowRight' || e.key === 'Right' || e.key === 'd') {
                    basket.movingRight = true;
                }
            });
            
            document.addEventListener('keyup', (e) => {
                if (e.key === 'ArrowLeft' || e.key === 'Left' || e.key === 'a') {
                    basket.movingLeft = false;
                }
                if (e.key === 'ArrowRight' || e.key === 'Right' || e.key === 'd') {
                    basket.movingRight = false;
                }
            });
            
            // æ»‘é¼ æ§åˆ¶
            canvas.addEventListener('mousemove', (e) => {
                if (!gameRunning || gamePaused) return;
                
                const rect = canvas.getBoundingClientRect();
                const mouseX = e.clientX - rect.left;
                
                basket.x = mouseX - basket.width / 2;
                
                // ç¢ºä¿ç±ƒå­ä¸æœƒç§»å‡ºç•«å¸ƒ
                if (basket.x < 0) basket.x = 0;
                if (basket.x + basket.width > canvas.width) {
                    basket.x = canvas.width - basket.width;
                }
            });
            
            // è§¸æ§æ§åˆ¶ï¼ˆç§»å‹•è¨­å‚™ï¼‰
            canvas.addEventListener('touchmove', (e) => {
                if (!gameRunning || gamePaused) return;
                
                e.preventDefault();
                const rect = canvas.getBoundingClientRect();
                const touchX = e.touches[0].clientX - rect.left;
                
                basket.x = touchX - basket.width / 2;
                
                // ç¢ºä¿ç±ƒå­ä¸æœƒç§»å‡ºç•«å¸ƒ
                if (basket.x < 0) basket.x = 0;
                if (basket.x + basket.width > canvas.width) {
                    basket.x = canvas.width - basket.width;
                }
            }, { passive: false });
            
            // æŒ‰éˆ•äº‹ä»¶
            document.getElementById('startBtn').addEventListener('click', () => {
                if (!gameRunning) {
                    initGame();
                    gameRunning = true;
                    gamePaused = false;
                    gameLoop = setInterval(gameUpdate, 1000 / 60); // 60 FPS
                    document.getElementById('startBtn').textContent = 'éŠæˆ²ä¸­...';
                    document.getElementById('startBtn').disabled = true;
                }
            });
            
            document.getElementById('pauseBtn').addEventListener('click', () => {
                if (gameRunning) {
                    gamePaused = !gamePaused;
                    document.getElementById('pauseBtn').textContent = 
                        gamePaused ? 'ç¹¼çºŒéŠæˆ²' : 'æš«åœ';
                }
            });
            
            document.getElementById('resetBtn').addEventListener('click', () => {
                initGame();
                gameRunning = false;
                gamePaused = false;
                clearInterval(gameLoop);
                draw();
                document.getElementById('startBtn').textContent = 'é–‹å§‹éŠæˆ²';
                document.getElementById('startBtn').disabled = false;
                document.getElementById('pauseBtn').textContent = 'æš«åœ';
            });
            
            document.getElementById('restartBtn').addEventListener('click', () => {
                initGame();
                gameRunning = true;
                gamePaused = false;
                gameLoop = setInterval(gameUpdate, 1000 / 60);
                document.getElementById('startBtn').textContent = 'éŠæˆ²ä¸­...';
                document.getElementById('startBtn').disabled = true;
                document.getElementById('pauseBtn').textContent = 'æš«åœ';
            });
            
            // çª—å£å¤§å°èª¿æ•´
            window.addEventListener('resize', () => {
                canvas.width = canvas.parentElement.clientWidth;
                canvas.height = canvas.parentElement.clientHeight;
                basket.y = canvas.height - 80;
                draw();
            });
        }
        
        // åˆå§‹åŒ–éŠæˆ²
        window.onload = function() {
            initGame();
            setupEventListeners();
        };
    </script>
</body>
</html>